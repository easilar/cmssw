Introduction to CMSSW: http://cms-sw.github.io


How to produce nanoAOD events of H to Tau tau where Higgs has 130 GeV mass. 

cmsrel CMSSW_10_2_22

cd CMSSW_10_2_22/src

cmsenv

git cms-addpkg Configuration/Generator

# pull from my repo from the from-CMSSW_10_2_22 branch
# https://github.com/easilar/cmssw/tree/from-CMSSW_10_2_22
# and add also Lucas' repo
git remote add ece git@github.com:easilar/cmssw.git
git fetch ece
git remote add lucas git@github.com:lucastorterotot/cmssw.git
git fetch lucas

# make sure scripts will be copied locally with git
for str in gen_* prod_*sh submit*sh ; do echo ./$str >> .git/info/sparse-checkout ; done

git checkout -b localmaster ece/from-CMSSW_10_2_22

scram b -j 8

scram b python

# If you want to generate event with PU, create MinBias events with
${CMSSW_BASE}/src/gen_PU_for_HTT

# Try to generate events:
cmsDriver.py H125GGgluonfusion_13TeV_TuneCUETP8M1_cfi --conditions auto:run2_mc --fast -n 200 --era Run2_2016 --eventcontent AODSIM --relval 100000,500 --step GEN,SIM,RECOBEFMIX,DIGI:pdigi_valid,L1,DIGI2RAW,L1Reco,RECO --beamspot Realistic50ns13TeVCollision --datatier AODSIM  --no_exec

cmsRun H125GGgluonfusion_13TeV_TuneCUETP8M1_cfi_GEN_SIM_RECOBEFMIX_DIGI_L1_DIGI2RAW_L1Reco_RECO.py

cmsDriver.py step3  --conditions auto:phase1_2017_realistic --fast  -n 200 --era Run2_2017_FastSim --eventcontent MINIAODSIM --runUnscheduled  --filein file:H125GGgluonfusion_13TeV_TuneCUETP8M1_cfi_GEN_SIM_RECOBEFMIX_DIGI_L1_DIGI2RAW_L1Reco_RECO.root -s PAT --datatier MINIAODSIM --mc

cmsDriver.py step1 --filein file:step3_PAT.root --fileout file:HIG_Nano_1.root --mc --eventcontent NANOAODSIM --datatier NANOAODSIM --conditions auto:phase1_2017_realistic --step NANO --fast --era Run2_2017_FastSim -n 200

If all run properly, you may use gen_HTT_at_mass with options -m to set the Higgs mass and -N for the amount of events:
${CMSSW_BASE}/src/gen_HTT_at_mass -m 130 -N 200

#Before running the scripts below create, if you do not have the config files for the desired higgs mass do the following
#You need to this step only onces
cd ${CMSSW_BASE}/src/Configuration/Generator/python/
#Example masses between 500 GeV to 600 GeV:
for i in {500..600}; do sed 's/25:m0 = 125/25:m0 = '"$i"'/g' H125GGgluonfusion_13TeV_TuneCUETP8M1_cfi.py > H"$i"GGgluonfusion_13TeV_TuneCUETP8M1_cfi.py; done
# make sure you do not erase the 125 GeV config file! Git can help you to recover it, if needed.

# To submit to slurm cluster
login machine : ssh -XY lyoui
#Multiple jobs at a time
sbatch --partition=long --array=120-125 --output=submit_array.out submit_array.sh
This will submit samples for 5 different masses from 120 GeV to 125 GeV
#Single job
mkdir /home/cms/"$USER"/slurmJobs/
sbatch submit_single.sh 90 60000 0  # this comment will submit a job for mass = 90 GeV for 60k events and no PU
#Multiple jobs each seperate jobs:
#the comment below will submit a job for the masses between 90 to 100 (in bins of 1 GeV) for 60 k events and 2017 PU profile. Each job will have a seperate job id
mkdir /home/cms/"$USER"/slurmJobs/
for i in {90..100}; do sbatch submit_single.sh $i 60000 2017 ; done

# A dedicated script setting explicit jobs names is available: submit_HTT_at_mass.sh
# Use it to produce 200 events at 750 GeV :
./submit_HTT_at_mass.sh -m 750 -N 200
# you can provide only the mass only of the Higgs and the amount of events will be automatically set.

